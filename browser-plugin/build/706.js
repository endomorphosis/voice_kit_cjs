(()=>{var e,r,t,o,a={895:(e,r,t)=>{"use strict";var o=t(969);let a;globalThis.__TRANSFORMER_WORKER_WASM_PATH__="/wasm/",console.log("Loading ASR model..."),async function(){try{try{if(!navigator.gpu)throw new Error("WebGPU is not supported in this browser");const e=await navigator.gpu.requestAdapter();if(!e)throw new Error("Failed to get WebGPU adapter");let r,t=[];try{r=await e.requestDevice({requiredFeatures:["shader-f16"]}),t.push("shader-f16")}catch(t){console.log("F16 shaders not supported, using standard WebGPU"),r=await e.requestDevice()}console.log("Using WebGPU adapter:",{name:e.name,features:Array.from(e.features),platform:navigator.platform});const n={execution_provider:["WebGPU","CPU"],optimization_level:99,gpu_adapter:e,gpu_device:r,fallback_to_cpu:!0};t.includes("shader-f16")&&(n.webgpu_options={shader_features:["f16"]}),a=await(0,o.TkF)("automatic-speech-recognition","onnx-community/whisper-tiny.en",{device:"webgpu",quantized:!0,model_kwargs:{encoder_config:n,decoder_config:n,decoder_merged_config:n}})}catch(e){console.warn("WebGPU initialization failed, falling back to WASM:",e),a=await(0,o.TkF)("automatic-speech-recognition","onnx-community/whisper-tiny.en",{device:"wasm",quantized:!0}),console.log("Successfully initialized ASR on WASM")}console.log("Testing ASR pipeline..."),await a(new Float32Array(16e3)),self.postMessage({type:"ready"})}catch(e){console.error("Failed to initialize ASR model:",e);const r=e.message.includes("WebGPU")?`WebGPU error: ${e.message}. Try updating your browser or graphics drivers.`:e.message;throw self.postMessage({type:"error",error:r}),new Error(r)}}(),self.onmessage=async e=>{const{buffer:r}=e.data;if(r&&r instanceof Float32Array)try{const{text:e}=await a(r);self.postMessage({type:"transcription",text:e})}catch(e){console.error("Transcription error:",e),self.postMessage({type:"error",error:e.toString(),details:{name:e.name,message:e.message,stack:e.stack}})}else self.postMessage({type:"error",error:"Invalid buffer format: "+(r?typeof r:"undefined")})}},193:()=>{},160:()=>{},448:()=>{},655:()=>{},626:()=>{},674:()=>{},666:()=>{}},n={};function s(e){var r=n[e];if(void 0!==r)return r.exports;var t=n[e]={exports:{}};return a[e](t,t.exports,s),t.exports}s.m=a,s.x=()=>{var e=s.O(void 0,[96],(()=>s(895)));return s.O(e)},e=[],s.O=(r,t,o,a)=>{if(!t){var n=1/0;for(f=0;f<e.length;f++){for(var[t,o,a]=e[f],i=!0,c=0;c<t.length;c++)(!1&a||n>=a)&&Object.keys(s.O).every((e=>s.O[e](t[c])))?t.splice(c--,1):(i=!1,a<n&&(n=a));if(i){e.splice(f--,1);var l=o();void 0!==l&&(r=l)}}return r}a=a||0;for(var f=e.length;f>0&&e[f-1][2]>a;f--)e[f]=e[f-1];e[f]=[t,o,a]},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,s.t=function(e,o){if(1&o&&(e=this(e)),8&o)return e;if("object"==typeof e&&e){if(4&o&&e.__esModule)return e;if(16&o&&"function"==typeof e.then)return e}var a=Object.create(null);s.r(a);var n={};r=r||[null,t({}),t([]),t(t)];for(var i=2&o&&e;"object"==typeof i&&!~r.indexOf(i);i=t(i))Object.getOwnPropertyNames(i).forEach((r=>n[r]=()=>e[r]));return n.default=()=>e,s.d(a,n),a},s.d=(e,r)=>{for(var t in r)s.o(r,t)&&!s.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((r,t)=>(s.f[t](e,r),r)),[])),s.u=e=>"vendors.js",s.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.p="/",(()=>{s.b=self.location+"";var e={706:1,882:1};s.f.i=(r,t)=>{e[r]||importScripts(s.p+s.u(r))};var r=self.webpackChunkbrowser_extension=self.webpackChunkbrowser_extension||[],t=r.push.bind(r);r.push=r=>{var[o,a,n]=r;for(var i in a)s.o(a,i)&&(s.m[i]=a[i]);for(n&&n(s);o.length;)e[o.pop()]=1;t(r)}})(),o=s.x,s.x=()=>s.e(96).then(o),s.x()})();
//# sourceMappingURL=706.js.map