(()=>{var e,r,t,o={895:(e,r,t)=>{"use strict";var o=t(969);let a;globalThis.__TRANSFORMER_WORKER_WASM_PATH__="/wasm/",console.log("Loading ASR model..."),async function(){try{try{if(!navigator.gpu)throw new Error("WebGPU is not supported in this browser");const e=await navigator.gpu.requestAdapter();if(!e)throw new Error("Failed to get WebGPU adapter");let r,t=[];try{r=await e.requestDevice({requiredFeatures:["shader-f16"]}),t.push("shader-f16")}catch(t){console.log("F16 shaders not supported, using standard WebGPU"),r=await e.requestDevice()}console.log("Using WebGPU adapter:",{name:e.name,features:Array.from(e.features),platform:navigator.platform});const n={execution_provider:["WebGPU","CPU"],optimization_level:99,gpu_adapter:e,gpu_device:r,fallback_to_cpu:!0};t.includes("shader-f16")&&(n.webgpu_options={shader_features:["f16"]}),a=await(0,o.TkF)("automatic-speech-recognition","onnx-community/whisper-tiny.en",{device:"webgpu",quantized:!0,model_kwargs:{encoder_config:n,decoder_config:n,decoder_merged_config:n}})}catch(e){console.warn("WebGPU initialization failed, falling back to WASM:",e),a=await(0,o.TkF)("automatic-speech-recognition","onnx-community/whisper-tiny.en",{device:"wasm",quantized:!0}),console.log("Successfully initialized ASR on WASM")}console.log("Testing ASR pipeline..."),await a(new Float32Array(16e3)),self.postMessage({type:"ready"})}catch(e){console.error("Failed to initialize ASR model:",e);const r=e.message.includes("WebGPU")?`WebGPU error: ${e.message}. Try updating your browser or graphics drivers.`:e.message;throw self.postMessage({type:"error",error:r}),new Error(r)}}(),self.onmessage=async e=>{const{buffer:r}=e.data;if(r&&r instanceof Float32Array)try{const{text:e}=await a(r);self.postMessage({type:"transcription",text:e})}catch(e){console.error("Transcription error:",e),self.postMessage({type:"error",error:e.toString(),details:{name:e.name,message:e.message,stack:e.stack}})}else self.postMessage({type:"error",error:"Invalid buffer format: "+(r?typeof r:"undefined")})}},193:()=>{},160:()=>{},448:()=>{},655:()=>{},626:()=>{},674:()=>{},666:()=>{}},a={};function n(e){var r=a[e];if(void 0!==r)return r.exports;var t=a[e]={exports:{}};return o[e](t,t.exports,n),t.exports}n.m=o,e=[],n.O=(r,t,o,a)=>{if(!t){var s=1/0;for(f=0;f<e.length;f++){for(var[t,o,a]=e[f],i=!0,c=0;c<t.length;c++)(!1&a||s>=a)&&Object.keys(n.O).every((e=>n.O[e](t[c])))?t.splice(c--,1):(i=!1,a<s&&(s=a));if(i){e.splice(f--,1);var l=o();void 0!==l&&(r=l)}}return r}a=a||0;for(var f=e.length;f>0&&e[f-1][2]>a;f--)e[f]=e[f-1];e[f]=[t,o,a]},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,n.t=function(e,o){if(1&o&&(e=this(e)),8&o)return e;if("object"==typeof e&&e){if(4&o&&e.__esModule)return e;if(16&o&&"function"==typeof e.then)return e}var a=Object.create(null);n.r(a);var s={};r=r||[null,t({}),t([]),t(t)];for(var i=2&o&&e;"object"==typeof i&&!~r.indexOf(i);i=t(i))Object.getOwnPropertyNames(i).forEach((r=>s[r]=()=>e[r]));return s.default=()=>e,n.d(a,s),a},n.d=(e,r)=>{for(var t in r)n.o(r,t)&&!n.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},n.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/",(()=>{n.b=document.baseURI||self.location.href;var e={706:0,882:0};n.O.j=r=>0===e[r];var r=(r,t)=>{var o,a,[s,i,c]=t,l=0;if(s.some((r=>0!==e[r]))){for(o in i)n.o(i,o)&&(n.m[o]=i[o]);if(c)var f=c(n)}for(r&&r(t);l<s.length;l++)a=s[l],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(f)},t=self.webpackChunkbrowser_extension=self.webpackChunkbrowser_extension||[];t.forEach(r.bind(null,0)),t.push=r.bind(null,t.push.bind(t))})();var s=n.O(void 0,[96],(()=>n(895)));s=n.O(s)})();
//# sourceMappingURL=asr-worker.js.map